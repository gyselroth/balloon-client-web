dist: trusty
sudo: false
language: node_js
node_js: '12'
os:
- linux
notifications:
  email: false
before_install:
- export version=$TRAVIS_TAG
- if [ "${version:0:1}" == "v" ]; then version=${version:1}; fi;
- if [ "$version" == "" ]; then version=$TRAVIS_BUILD_NUMBER; fi;
script:
- make build
- if [ "$TRAVIS_TAG" != "" ]; then make dist VERSION=$version; fi
deploy:
- provider: releases
  api_key:
    secure: WXsFv62P7BYeM0s32rcGx/LqdwECQRvUJWJ8YDZ4jdv8w4O4vlCLURiwW/65WNi7peKiMpPmv7q/NOtNrXT1PDIMyeMeJvToHGELyepGex0v1goqfURExpIEm8ddC2HiJf7ctgk7V5CichL/1DpJ2BWzCMUi1OnhLfjWpXQz4OZN8X5XwcgtMjUzEy/Ry1xMbbhrBs4a3IKyBJsbN7TRWibHsJHfl5pvk5qq7xL2s8/5/vEwMDZYFdK8BraF9AOUSqTqrDv2dfdkQrbZNiS2vPGAHdP+YRGGlbZoyHU10wIYJ3zEJ5zVtnAxa7TawZaomPVo6eglr9EuE5D79LVQVHLpBiSfAUViYuZkgxaAgeh4lpgpHgjeIYbetZ4arAcpov3Dnkpqc2Iu95M2jN5ehFtSP23OBoSxseJ3aHwQEnKJy9N6Yhww+l6E6HGqUaa+cVlVdP2zhu462oWH/4HVb1V9yrXij5+/Lo/JWYw58t86gpQTL3DmQQ0SSSj/iwaTN/qpJtzRv2ZfTY7RDS/MUiCZLf8zJ4c+BzBUVBRhIvq8LGusVhszOUhkHqndtaGHGI0+anNvvCTLUv09tOhp1m7uLB6xRloxQPdIcYfNN20+WL/zUYqOLmUx3wc0bpLh8LCHj8wbGYW7RbYcKQw66BmKgfLxUdBEBISDkgKuYx0=
  file_glob: true
  file: dist/*
  skip_cleanup: true
  on:
    tags: true
after_script:
  - test "$TRAVIS_TAG" != "" && version=${TRAVIS_TAG:1};
  - test "$TRAVIS_TAG" != "" && docker login -u "$DOCKER_USERNAME" -p "$DOCKER_PASSWORD"
  - test "$TRAVIS_TAG" != "" && docker tag gyselroth/balloon-web:$version gyselroth/balloon-web:$docker_tag
  - test "$TRAVIS_TAG" != "" && docker push gyselroth/balloon-web:$version
  - test "$TRAVIS_TAG" != "" && docker push gyselroth/balloon-web:$docker_tag
env:
  global:
  - secure: m13MizT1AcfECjdbtO7HkyNU4fNti73FhsAJu88DIY2k97zERfZWybABEcCZYShGByuwJJpi4Gr23G2QIBKb9zDDAGXYJw9BjN3lbCT8SGIu/eEBUi3FZRR0p/sjA3Re9pQuSGHxBZwUouPsUHyyugdLij5/8s0oJBPaWYRv/HWfd862d4y9pV8VpG+2EUEqC2oDWRvRQdFRTNu7/XgSKj/7Xf3Rz0BBFT0jEMb4x11R+9QctqRqDK85WsZEwquTrHOkvs9j50Ojim1DZ/AuPWicv1KYT1aMjeTWkhcZjFQ15tfuKhKj872fA7ohd8Qqp2ygGk88pU+2w0WyeiwHbp8GHtNHOQqO8B7kXqslo2ZXZs36nKP6E/n7Lw37MeJOgW6Py2QIx/1VNRv9tpybTq3CzgxXa2A8uw1gdjwH0kdmJZ/AM+oDq5lq4RjgVx4Ne4bcQpwe0p19AhtdO9P5kjdNPor6UgBmx6IFoyiaBcrrHYbZue7IfPL83BkXuPu07oocFB558kcQ+TV+8RuHhID7Kg+slsWaRwIxia1AUEWNEAjLfVgoXkHzCdTtdvS5HPGvKTz8a62yfQqYCFeCn6Ioi4mPTtYRLsnynuZoktYe3oSzJcqz3T/RKcinOxjTxJ5DJUSgkhbruPaImEwweJS87pwe5SlMMX18xjVNVUo=
